/**
 * @name jquery.Thailand.js
 * @version 1.1.0
 * @update Apr 8, 2017
 * @website https://github.com/earthchie/jquery.Thailand.js
 * @license WTFPL v.2 - http://www.wtfpl.net/
 *
 * @dependency: jQuery <https://jquery.com/>
 *              typehead.js <https://twitter.github.io/typeahead.js/>
 *              JQL.js <https://github.com/earthchie/JQL.js>
 **/
$.Thailand=function(e){"use strict";function t(e){if(!e[0].length)return e;var t=[];return e.forEach(function(e){var a=e[0];e[1].forEach(function(e){var n=e[0];e[1].forEach(function(e){var o=e[0];e[1].forEach(function(e){t.push({d:o,a:n,p:a,z:e})})})})}),t}e=$.extend({database:"./data.json",autocomplete_size:20,onComplete:function(){},$district:$('[name="district"]'),$amphoe:$('[name="amphoe"]'),$province:$('[name="province"]'),$zipcode:$('[name="zipcode"]')},e),$.getJSON(e.database,function(a){var n=new JQL(t(a)),o={hint:!0,highlight:!0,minLength:0},c={empty:" ",suggestion:function(e){return"<div>"+e.d+" » "+e.a+" » "+e.p+" » "+(e.z||"<i>ไม่มีรหัสไปรษณีย์</i>")+"</div>"}},i=function(t,a){e.$district.val(a.d),e.$amphoe.val(a.a),e.$province.val(a.p),e.$zipcode.val(a.z)};e.$district.typeahead(o,{limit:e.autocomplete_size,templates:c,source:function(e){return function(e,t){var a=[];try{a=n.select("*").where("d").match("^"+e).orderBy("d").fetch()}catch(e){}t(a)}}(),display:function(e){return e.d}}),e.$amphoe.typeahead(o,{limit:e.autocomplete_size,templates:c,source:function(e){return function(e,t){var a=[];try{a=n.select("*").where("a").match("^"+e).orderBy("a").fetch()}catch(e){}t(a)}}(),display:function(e){return e.a}}),e.$province.typeahead(o,{limit:e.autocomplete_size,templates:c,source:function(e){return function(e,t){var a=[];try{a=n.select("*").where("p").match("^"+e).orderBy("p").fetch()}catch(e){}t(a)}}(),display:function(e){return e.p}}),e.$zipcode.typeahead(o,{limit:e.autocomplete_size,templates:c,source:function(e){return function(e,t){var a=[];try{a=n.select("*").where("z").match("^"+e).orderBy("z").fetch()}catch(e){}t(a)}}(),display:function(e){return e.z}}),e.$district.bind("typeahead:select typeahead:autocomplete",i),e.$amphoe.bind("typeahead:select typeahead:autocomplete",i),e.$province.bind("typeahead:select typeahead:autocomplete",i),e.$zipcode.bind("typeahead:select typeahead:autocomplete",i),"function"==typeof e.onComplete&&e.onComplete()}).fail(function(t){throw new Error('Error: File "'+e.database+'" is not exists.')})};
